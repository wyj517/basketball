import{_ as oe,r as m,j as le,k as ne,c as w,o as g,l as re,b as t,d as U,n as y,t as r,m as c,i as ce,p as ie,F as D,f as P,w as j,e as ue,u as de,E as z,q as me,s as H,h as K}from"./index-CMqn_tIu.js";import{u as L,w as ve}from"./xlsx-CKN5doRT.js";import{u as pe}from"./team-yOgettLG.js";const he="data:image/svg+xml,%3c?xml%20version='1.0'%20standalone='no'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg%20t='1764147916161'%20class='icon'%20viewBox='0%200%201024%201024'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20p-id='6989'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20width='32'%20height='32'%3e%3cpath%20d='M767.7%20480.9H207.1l217.7-217.7c12.3-12.3%2012.3-32.4%200-44.7l-0.7-0.7c-12.3-12.3-32.4-12.3-44.7%200.1L107%20490.3c-12.3%2012.3-12.3%2032.4%200%2044.7l0.6%200.7c0.1%200%200.2%200.1%200.2%200.1l271.1%20271.1c12.5%2012.5%2032.9%2012.5%2045.4%200s12.5-32.9%200-45.4L206.7%20543.9h561c17.3%200%2031.5-14.2%2031.5-31.5s-14.2-31.5-31.5-31.5z'%20fill='%23fff'%20p-id='6990'%3e%3c/path%3e%3cpath%20d='M864.1%20512.6a31.8%2031.7%200%201%200%2063.6%200%2031.8%2031.7%200%201%200-63.6%200Z'%20fill='%23fff'%20p-id='6991'%3e%3c/path%3e%3c/svg%3e",fe="data:image/svg+xml,%3c?xml%20version='1.0'%20standalone='no'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg%20t='1764147907945'%20class='icon'%20viewBox='0%200%201024%201024'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20p-id='5996'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20width='32'%20height='32'%3e%3cpath%20d='M918.6%20489.3L646.1%20216.8c-12.3-12.3-32.5-12.3-44.8%200l-0.7%200.7c-12.3%2012.3-12.3%2032.4%200%2044.7l218.7%20218.7H257.6c-17.3%200-31.5%2014.2-31.5%2031.5s14.2%2031.5%2031.5%2031.5h560.1L601.2%20760.5c-12.5%2012.5-12.5%2032.9%200%2045.4s32.9%2012.5%2045.4%200l271.1-271.1s0.1-0.1%200.2-0.1l0.7-0.7c12.3-12.3%2012.3-32.4%200-44.7z'%20fill='%23fff'%20p-id='5997'%3e%3c/path%3e%3cpath%20d='M97.6%20512.6a31.8%2031.7%200%201%200%2063.6%200%2031.8%2031.7%200%201%200-63.6%200Z'%20fill='%23fff'%20p-id='5998'%3e%3c/path%3e%3c/svg%3e",we="data:image/svg+xml,%3c?xml%20version='1.0'%20standalone='no'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg%20t='1764149445455'%20class='icon'%20viewBox='0%200%201024%201024'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20p-id='8070'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20width='32'%20height='32'%3e%3cpath%20d='M784%20304C710.4%20233.6%20620.8%20195.2%20512%20192c-108.8%203.2-198.4%2041.6-272%20112S131.2%20467.2%20128%20576c3.2%20108.8%2041.6%20198.4%20112%20272S403.2%20956.8%20512%20960c108.8-3.2%20198.4-41.6%20272-112S892.8%20684.8%20896%20576c-3.2-108.8-41.6-198.4-112-272z%20m-44.8%20499.2C678.4%20864%20601.6%20892.8%20512%20896c-89.6-3.2-166.4-32-227.2-92.8C224%20742.4%20195.2%20665.6%20192%20576c3.2-89.6%2032-166.4%2092.8-227.2C345.6%20288%20422.4%20259.2%20512%20256c89.6%203.2%20166.4%2032%20227.2%2092.8C800%20409.6%20832%20483.2%20832%20576c-3.2%2089.6-32%20166.4-92.8%20227.2z'%20fill='%23515151'%20p-id='8071'%3e%3c/path%3e%3cpath%20d='M512%20320c9.6%200%2016%203.2%2022.4%209.6%206.4%206.4%209.6%2012.8%209.6%2022.4V576c0%209.6-3.2%2016-9.6%2022.4-6.4%206.4-12.8%209.6-22.4%209.6-9.6%200-16-3.2-22.4-9.6-6.4-6.4-9.6-12.8-9.6-22.4V352c0-9.6%203.2-16%209.6-22.4%206.4-6.4%2012.8-9.6%2022.4-9.6z'%20fill='%23515151'%20p-id='8072'%3e%3c/path%3e%3cpath%20d='M448%20576c0%2019.2%206.4%2032%2019.2%2044.8%2012.8%2012.8%2025.6%2019.2%2044.8%2019.2%2019.2%200%2032-6.4%2044.8-19.2%2012.8-12.8%2019.2-25.6%2019.2-44.8%200-19.2-6.4-32-19.2-44.8-12.8-12.8-25.6-19.2-44.8-19.2-19.2%200-32%206.4-44.8%2019.2-12.8%2012.8-19.2%2025.6-19.2%2044.8zM544%20128v128h-64V128H384c-9.6%200-16-3.2-22.4-9.6-6.4-6.4-9.6-12.8-9.6-22.4%200-9.6%203.2-16%209.6-22.4%206.4-6.4%2012.8-9.6%2022.4-9.6h256c9.6%200%2016%203.2%2022.4%209.6%206.4%206.4%209.6%2012.8%209.6%2022.4%200%209.6-3.2%2016-9.6%2022.4-6.4%206.4-12.8%209.6-22.4%209.6H544z'%20fill='%23515151'%20p-id='8073'%3e%3c/path%3e%3c/svg%3e",R="data:image/svg+xml,%3c?xml%20version='1.0'%20standalone='no'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg%20t='1764141125458'%20class='icon'%20viewBox='0%200%203008%201024'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20p-id='8885'%20width='94'%20height='32'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cpath%20d='M0%200h3008L2368%201024H0z'%20fill='%23cdcdcd'%20p-id='8886'%3e%3c/path%3e%3c/svg%3e",ge={class:"match-container"},ke={class:"team"},be={class:"source"},ye={class:"scoreboards"},_e={class:"fouls"},Ce={class:"timeouts"},Se={class:"game-info",style:{order:"2"}},Be={class:"score-details"},Te={class:"score-details-info"},xe={class:"time-left"},De={style:{"font-variant-numeric":"tabular-nums"}},Pe={class:"fouls"},Ee={class:"timeouts"},Ae={class:"roster-content"},Me={class:"player-grid"},Ve=["onClick"],ze={class:"player-num simple"},Le={class:"player-name"},Ne={class:"action-number"},$e={class:"player-grid"},Fe=["onClick"],Ge={class:"player-num circle-bg"},Ie={class:"player-name"},qe={class:"action-number"},Oe={class:"panel-container"},Ue={class:"action-grid"},je=["onClick"],He={class:"btn-text"},Ke={key:0,class:"btn-sub"},Re={class:"panel-container"},We={class:"action-grid"},Xe=["onClick"],Ye={class:"btn-text"},Je={key:0,class:"btn-sub"},Ze={class:"footer-actions"},E=30,Qe={__name:"second",setup(et){const e=pe(),C=m(!1),S=m(!1),A=m(!0),W=[{label:"篮板",type:"teal",key:"rebound"},{label:"助攻",type:"teal",key:"assist"},{label:"盖帽",type:"teal",key:"block"},{label:"抢断",type:"teal",key:"steal"},{label:"暂停",sub:"长按选择时间",type:"teal",key:"timeout"},{label:"二分命中",type:"teal",key:"score2"},{label:"三分命中",type:"teal",key:"score3"},{label:"罚球命中",type:"teal",key:"score1"},{label:"犯规",type:"red",key:"foul"},{label:"技术犯规",type:"red",key:"tech-foul"},{label:"违体",type:"red",key:"unsportsman"},{label:"夺权",type:"red",key:"disqualify"}],X=[{label:"换边",type:"teal",key:"changeSides"},{label:"切换球权",type:"teal",key:"possession"},{label:"打开大屏",type:"teal",key:"open"},{label:"导出比赛数据",type:"teal",key:"exportExcel"},{label:"隐藏人员面板",type:"teal",key:"hide"}],N=s=>{switch(s.key){case"score2":_(2),v.value===1?e.teamA.players[i.value].twoSource++:e.teamB.players[i.value].twoSource++;break;case"score3":_(3),console.log("3分",i.value),v.value===1?e.teamA.players[i.value].threeSource++:(console.log("3分",e.teamB.players),e.teamB.players[i.value].threeSource++);break;case"score1":_(1),v.value===1?e.teamA.players[i.value].oneSource++:e.teamB.players[i.value].oneSource++;break;case"timeout":Q(v.value);break;case"foul":T();break;case"tech-foul":T(),v.value===1?e.teamA.players[i.value].jsfg++:e.teamB.players[i.value].jsfg++;break;case"unsportsman":T(),v.value===1?e.teamA.players[i.value].wt++:e.teamB.players[i.value].wt++;break;case"disqualify":T(),v.value===1?e.teamA.players[i.value].dq++:e.teamB.players[i.value].dq++;break;case"open":ae();break;case"hide":A.value=!A.value,b("hide");break;case"possession":M.value=!M.value,b("possession");break;case"changeSides":h.value=!h.value,b("swap");break;case"exportExcel":se();break}C.value=!1},M=m(!0),h=m(!0);me();const Y=de();m("wa"),m({name:"XX1队",players:[]}),m({name:"XX2队",players:[]}),m({totalPeriods:4,periodTime:12,breakTime:2,enable24Seconds:!0});const p=m(!0),x=m("playing"),$=m(0),v=m(1),i=m(0),k=m(null);le(()=>{window.addEventListener("keydown",I)}),ne(()=>{window.removeEventListener("keydown",I)});function F(s){if(s<=0)return"00''00''";const a=Math.ceil(s/1e3);if(a>60){const d=Math.floor(a/60).toString().padStart(2,"0"),o=(a%60).toString().padStart(2,"0");return`${d}:${o}`}else{const d=Math.floor(s/1e3).toString().padStart(2,"0"),o=Math.floor(s%1e3/10).toString().padStart(2,"0");return`${d}''${o}''`}}function J(){k.value||(x.value==="ready"&&(x.value="playing"),k.value=setInterval(()=>{x.value==="playing"?p.value?e.timer.periodTime>0?e.timer.periodTime-=E:(e.timer.periodTime=0,B(),e.currentPeriod==e.totalPeriods?alert("比赛结束"):z.alert("本节结束，是否进入场间休息","",{confirmButtonText:"确定",showCancelButton:!1}).then(()=>{e.resetTime(p.value),p.value=!1}).catch(()=>{console.log("用户取消了操作")})):e.timer.breakTime>0?e.timer.breakTime-=E:(e.timer.breakTime=0,B(),z.alert("本节结束，是否进入场间休息","",{confirmButtonText:"确定",showCancelButton:!1}).then(()=>{e.resetTime(p.value),e.addCurrentPeriod(),p.value=!0}).catch(()=>{console.log("用户取消了操作")})):x.value==="resting"&&$.value>0&&($.value-=E)},E))}function B(){clearInterval(k.value),k.value=null}function Z(){k.value?B():J(),b("time")}function G(s,a){v.value=s,i.value=a,C.value=!0}function Q(s){e.addPause(v.value),B(),b("pause",s),b("time")}function _(s){e.addScore(i.value,s,v.value);try{const a=new BroadcastChannel("matchDataChannel"),d=JSON.parse(JSON.stringify(e.$state)),o={type:"scoreAdded",team:v.value,points:s,state:d};a.postMessage(o)}catch(a){console.error("BroadcastChannel Error:",a)}}function T(){e.addFoul(i.value,v.value),b("foul",v.value,i.value)}function b(s,a,d){if(s==="foul")try{const o=new BroadcastChannel("matchDataChannel"),u={type:s,teamFoul:a===1?e.teamA.teamFoul:e.teamB.teamFoul,foul:a===1?e.teamA.players[d].foul:e.teamB.players[d].foul,team:a,sectionFoul:a===1?e.teamA.SectionFouls[e.currentPeriod]:e.teamB.SectionFouls[e.currentPeriod],playIndex:d,currentPeriod:e.currentPeriod};o.postMessage(u)}catch(o){console.error("BroadcastChannel Error:",o)}else if(s==="pause")try{const o=new BroadcastChannel("matchDataChannel"),u={type:s,pause:a===1?e.teamA.teamPauses:e.teamB.teamPauses,team:a};o.postMessage(u)}catch(o){console.error("BroadcastChannel Error:",o)}else if(s==="time")try{const o=new BroadcastChannel("matchDataChannel"),u={type:s,time:!!k.value,timeType:p.value,currentPeriod:e.currentPeriod,periodTime:e.timer.periodTime,breakTime:e.timer.breakTime};o.postMessage(u)}catch(o){console.error("BroadcastChannel Error:",o)}else if(s==="hide")try{const o=new BroadcastChannel("matchDataChannel"),u={type:s,hide:A.value};o.postMessage(u)}catch(o){console.error("BroadcastChannel Error:",o)}else if(s==="possession")try{const o=new BroadcastChannel("matchDataChannel"),u={type:s,possession:M.value};o.postMessage(u)}catch(o){console.error("BroadcastChannel Error:",o)}else if(s==="swap")try{const o=new BroadcastChannel("matchDataChannel"),u={type:s,swap:h.value};o.postMessage(u)}catch(o){console.error("BroadcastChannel Error:",o)}}function ee(){p.value?e.addCurrentPeriod():z.alert("是否结束休息","",{confirmButtonText:"确定",showCancelButton:!1}).then(()=>{e.resetTime(p.value),e.addCurrentPeriod(),B(),b("time"),p.value=!0}).catch(()=>{console.log("用户取消了操作")})}function te(){e.subCurrentPeriod()}function I(s){if(!(s.target.tagName==="INPUT"||s.target.tagName==="TEXTAREA"))switch(s.key.toLowerCase()){case"1":s.preventDefault(),_(1);break;case"2":case"enter":s.preventDefault(),_(2);break;case"3":s.preventDefault(),_(3);break;case"f":s.preventDefault(),T();break;case"g":s.preventDefault();break;case"z":(s.ctrlKey||s.metaKey||!s.ctrlKey&&!s.metaKey)&&s.preventDefault();break;case" ":s.preventDefault();break}}function ae(){window.open("#/test","_blank")}function se(){try{const s=[];s.push(["队伍","号码","姓名","得分","犯规","二分命中次数","三分命中次数","罚球命中次数","篮板","助攻","盖帽","抢断","技术犯规","违体","夺权"]),e.teamA.players.forEach(l=>{s.push([e.teamA.name||"A队",l.number,l.name||"",l.score||0,l.foul||0,l.twoSource||0,l.threeSource||0,l.oneSource||0,l.lb||0,l.zg||0,l.gm||0,l.qd||0,l.jsfg||0,l.wt||0,l.dq||0])}),e.teamB.players.forEach(l=>{s.push([e.teamB.name||"B队",l.number,l.name||"",l.score||0,l.foul||0,l.twoSource||0,l.threeSource||0,l.oneSource||0,l.lb||0,l.zg||0,l.gm||0,l.qd||0,l.jsfg||0,l.wt||0,l.dq||0])});const a=L.aoa_to_sheet(s),d=L.book_new();L.book_append_sheet(d,a,"比赛数据");const u=`比赛数据_${new Date().toISOString().replace(/[:.]/g,"-")}.xlsx`;ve(d,u)}catch{alert("Excel导出失败，请重试")}}function q(){confirm("确定要结束比赛吗？结束后将返回首页。")&&Y.push("/")}return(s,a)=>{var o,u,l,O;const d=ue("el-drawer");return g(),w("div",ge,[a[16]||(a[16]=re('<header class="top-nav" data-v-c1e2f684><div class="nav-pill" data-v-c1e2f684><span class="nav-item active" data-v-c1e2f684>比赛</span><span class="nav-item" data-v-c1e2f684>工作台</span><span class="nav-item" data-v-c1e2f684>我的</span></div></header>',1)),t("div",{class:"sub-header"},[t("span",{class:"back-icon",onClick:q,style:{cursor:"pointer"}},"<"),a[7]||(a[7]=t("h2",{class:"title"},"技术统计",-1)),t("div",{class:"actions"},[a[6]||(a[6]=t("span",{class:"icon"},null,-1)),t("button",{class:"end-btn",onClick:q},"结束")])]),t("div",ke,[t("div",{class:"team-info left",style:y({order:h.value?1:2})},r(c(e).teamA.name),5),t("div",be,[t("p",null,r(String(c(e).teamA.score||0).padStart(2,"0")),1),a[8]||(a[8]=t("p",null,":",-1)),t("p",null,r(String(c(e).teamB.score||0).padStart(2,"0")),1)]),t("div",{class:"team-info right",style:y({order:h.value?2:1})},r(c(e).teamB.name),5)]),t("div",ye,[t("div",{class:"scoreboard-info",style:y({order:h.value?1:3})},[t("div",_e,[a[9]||(a[9]=t("p",null,"犯规",-1)),t("p",null,r(((o=c(e).teamA.SectionFouls)==null?void 0:o[c(e).currentPeriod])??0),1)]),t("div",Ce,[a[10]||(a[10]=t("p",null,"暂停",-1)),t("p",null,r(c(e).teamA.teamPauses),1)])],4),t("div",Se,[t("div",Be,[t("img",{src:he,alt:"",style:{width:"24px",height:"24px"},onClick:te}),t("div",Te,[t("div",null,r(p.value?"第"+c(e).currentPeriod+"节":"节间休息"),1),ce(t("div",null,r(((u=c(e).teamA.periodScores)==null?void 0:u[c(e).currentPeriod])??0)+" : "+r(((l=c(e).teamB.periodScores)==null?void 0:l[c(e).currentPeriod])??0),513),[[ie,p.value]])]),t("img",{src:fe,alt:"",style:{width:"24px",height:"24px"},onClick:ee})]),t("div",{class:"time",onClick:Z},[t("div",xe,[a[11]||(a[11]=t("img",{src:we,alt:""},null,-1)),t("p",{style:y([{color:k.value?"red":"black"},{cursor:"pointer"}])},r(k.value?"暂停计时":"开始计时"),5)]),t("p",De,r(p.value?F(c(e).timer.periodTime):F(c(e).timer.breakTime)),1)])]),t("div",{class:"scoreboard-info",style:y({order:h.value?3:1})},[t("div",Pe,[t("p",null,r(((O=c(e).teamB.SectionFouls)==null?void 0:O[c(e).currentPeriod])??0),1),a[12]||(a[12]=t("p",null,"犯规",-1))]),t("div",Ee,[t("p",null,r(c(e).teamB.teamPauses),1),a[13]||(a[13]=t("p",null,"暂停",-1))])],4)]),t("div",Ae,[t("div",{class:"team-column",style:y({order:h.value?1:2})},[t("div",Me,[(g(!0),w(D,null,P(c(e).teamA.players,(n,f)=>(g(),w("div",{key:f,class:"player-card",onClick:V=>G(1,f)},[t("div",ze,r(n.number),1),t("div",Le,r(n.name),1),t("div",null,[a[14]||(a[14]=t("img",{src:R,alt:"",class:"action-btn"},null,-1)),t("p",Ne,r(n.number),1)])],8,Ve))),128))])],4),t("div",{class:"team-column",style:y({order:h.value?2:1})},[t("div",$e,[(g(!0),w(D,null,P(c(e).teamB.players,(n,f)=>(g(),w("div",{key:f,class:"player-card",onClick:V=>G(2,f)},[t("div",Ge,r(n.number),1),t("div",Ie,r(n.name),1),t("div",null,[a[15]||(a[15]=t("img",{src:R,alt:"",class:"action-btn"},null,-1)),t("p",qe,r(n.number),1)])],8,Fe))),128))])],4)]),U(d,{modelValue:C.value,"onUpdate:modelValue":a[1]||(a[1]=n=>C.value=n),direction:"btt",size:"auto","with-header":!1,class:"action-drawer"},{default:j(()=>[t("div",Oe,[t("div",{class:"drag-handle",onClick:a[0]||(a[0]=n=>C.value=!1)}),t("div",Ue,[(g(),w(D,null,P(W,(n,f)=>t("div",{key:f,class:H(["grid-item",n.type]),onClick:V=>N(n)},[t("span",He,r(n.label),1),n.sub?(g(),w("span",Ke,r(n.sub),1)):K("",!0)],10,je)),64))])])]),_:1},8,["modelValue"]),U(d,{modelValue:S.value,"onUpdate:modelValue":a[3]||(a[3]=n=>S.value=n),direction:"btt",size:"auto","with-header":!1,class:"action-drawer"},{default:j(()=>[t("div",Re,[t("div",{class:"drag-handle",onClick:a[2]||(a[2]=n=>S.value=!1)}),t("div",We,[(g(),w(D,null,P(X,(n,f)=>t("div",{key:f,class:H(["grid-item",n.type]),onClick:V=>N(n)},[t("span",Ye,r(n.label),1),n.sub?(g(),w("span",Je,r(n.sub),1)):K("",!0)],10,Xe)),64))])])]),_:1},8,["modelValue"]),t("footer",Ze,[t("button",{class:"add-btn left",onClick:a[4]||(a[4]=n=>S.value=!0)},"+"),t("button",{class:"add-btn right dark",onClick:a[5]||(a[5]=n=>S.value=!0)},"+")])])}}},ot=oe(Qe,[["__scopeId","data-v-c1e2f684"]]);export{ot as default};
