import{_ as oe,r as m,j as le,k as ne,c as f,o as w,l as re,b as t,d as U,t as r,m as c,i as ce,n as ie,p as V,F as x,f as D,w as j,e as de,u as ue,E as z,q as me,s as H,h as K}from"./index-DGgZ81aK.js";import{u as L,w as pe}from"./xlsx-CKN5doRT.js";import{u as ve}from"./team-CBo1ln3D.js";const he="data:image/svg+xml,%3c?xml%20version='1.0'%20standalone='no'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg%20t='1764147916161'%20class='icon'%20viewBox='0%200%201024%201024'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20p-id='6989'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20width='32'%20height='32'%3e%3cpath%20d='M767.7%20480.9H207.1l217.7-217.7c12.3-12.3%2012.3-32.4%200-44.7l-0.7-0.7c-12.3-12.3-32.4-12.3-44.7%200.1L107%20490.3c-12.3%2012.3-12.3%2032.4%200%2044.7l0.6%200.7c0.1%200%200.2%200.1%200.2%200.1l271.1%20271.1c12.5%2012.5%2032.9%2012.5%2045.4%200s12.5-32.9%200-45.4L206.7%20543.9h561c17.3%200%2031.5-14.2%2031.5-31.5s-14.2-31.5-31.5-31.5z'%20fill='%23fff'%20p-id='6990'%3e%3c/path%3e%3cpath%20d='M864.1%20512.6a31.8%2031.7%200%201%200%2063.6%200%2031.8%2031.7%200%201%200-63.6%200Z'%20fill='%23fff'%20p-id='6991'%3e%3c/path%3e%3c/svg%3e",fe="data:image/svg+xml,%3c?xml%20version='1.0'%20standalone='no'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg%20t='1764147907945'%20class='icon'%20viewBox='0%200%201024%201024'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20p-id='5996'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20width='32'%20height='32'%3e%3cpath%20d='M918.6%20489.3L646.1%20216.8c-12.3-12.3-32.5-12.3-44.8%200l-0.7%200.7c-12.3%2012.3-12.3%2032.4%200%2044.7l218.7%20218.7H257.6c-17.3%200-31.5%2014.2-31.5%2031.5s14.2%2031.5%2031.5%2031.5h560.1L601.2%20760.5c-12.5%2012.5-12.5%2032.9%200%2045.4s32.9%2012.5%2045.4%200l271.1-271.1s0.1-0.1%200.2-0.1l0.7-0.7c12.3-12.3%2012.3-32.4%200-44.7z'%20fill='%23fff'%20p-id='5997'%3e%3c/path%3e%3cpath%20d='M97.6%20512.6a31.8%2031.7%200%201%200%2063.6%200%2031.8%2031.7%200%201%200-63.6%200Z'%20fill='%23fff'%20p-id='5998'%3e%3c/path%3e%3c/svg%3e",we="data:image/svg+xml,%3c?xml%20version='1.0'%20standalone='no'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg%20t='1764149445455'%20class='icon'%20viewBox='0%200%201024%201024'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20p-id='8070'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20width='32'%20height='32'%3e%3cpath%20d='M784%20304C710.4%20233.6%20620.8%20195.2%20512%20192c-108.8%203.2-198.4%2041.6-272%20112S131.2%20467.2%20128%20576c3.2%20108.8%2041.6%20198.4%20112%20272S403.2%20956.8%20512%20960c108.8-3.2%20198.4-41.6%20272-112S892.8%20684.8%20896%20576c-3.2-108.8-41.6-198.4-112-272z%20m-44.8%20499.2C678.4%20864%20601.6%20892.8%20512%20896c-89.6-3.2-166.4-32-227.2-92.8C224%20742.4%20195.2%20665.6%20192%20576c3.2-89.6%2032-166.4%2092.8-227.2C345.6%20288%20422.4%20259.2%20512%20256c89.6%203.2%20166.4%2032%20227.2%2092.8C800%20409.6%20832%20483.2%20832%20576c-3.2%2089.6-32%20166.4-92.8%20227.2z'%20fill='%23515151'%20p-id='8071'%3e%3c/path%3e%3cpath%20d='M512%20320c9.6%200%2016%203.2%2022.4%209.6%206.4%206.4%209.6%2012.8%209.6%2022.4V576c0%209.6-3.2%2016-9.6%2022.4-6.4%206.4-12.8%209.6-22.4%209.6-9.6%200-16-3.2-22.4-9.6-6.4-6.4-9.6-12.8-9.6-22.4V352c0-9.6%203.2-16%209.6-22.4%206.4-6.4%2012.8-9.6%2022.4-9.6z'%20fill='%23515151'%20p-id='8072'%3e%3c/path%3e%3cpath%20d='M448%20576c0%2019.2%206.4%2032%2019.2%2044.8%2012.8%2012.8%2025.6%2019.2%2044.8%2019.2%2019.2%200%2032-6.4%2044.8-19.2%2012.8-12.8%2019.2-25.6%2019.2-44.8%200-19.2-6.4-32-19.2-44.8-12.8-12.8-25.6-19.2-44.8-19.2-19.2%200-32%206.4-44.8%2019.2-12.8%2012.8-19.2%2025.6-19.2%2044.8zM544%20128v128h-64V128H384c-9.6%200-16-3.2-22.4-9.6-6.4-6.4-9.6-12.8-9.6-22.4%200-9.6%203.2-16%209.6-22.4%206.4-6.4%2012.8-9.6%2022.4-9.6h256c9.6%200%2016%203.2%2022.4%209.6%206.4%206.4%209.6%2012.8%209.6%2022.4%200%209.6-3.2%2016-9.6%2022.4-6.4%206.4-12.8%209.6-22.4%209.6H544z'%20fill='%23515151'%20p-id='8073'%3e%3c/path%3e%3c/svg%3e",R="data:image/svg+xml,%3c?xml%20version='1.0'%20standalone='no'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg%20t='1764141125458'%20class='icon'%20viewBox='0%200%203008%201024'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20p-id='8885'%20width='94'%20height='32'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cpath%20d='M0%200h3008L2368%201024H0z'%20fill='%23cdcdcd'%20p-id='8886'%3e%3c/path%3e%3c/svg%3e",ge={class:"match-container"},be={class:"team"},ke={class:"team-info left"},_e={class:"source"},ye={class:"team-info right"},Ce={class:"scoreboards"},Se={class:"scoreboard-info"},Be={class:"fouls"},Te={class:"timeouts"},xe={class:"game-info"},De={class:"score-details"},Pe={class:"score-details-info"},Ee={class:"time-left"},Ae={style:{"font-variant-numeric":"tabular-nums"}},Me={class:"scoreboard-info"},Ve={class:"fouls"},ze={class:"timeouts"},Le={class:"roster-content"},Ne={class:"player-grid"},$e=["onClick"],Fe={class:"player-num simple"},Ge={class:"player-name"},Ie={class:"action-number"},qe={class:"player-grid"},Oe=["onClick"],Ue={class:"player-num circle-bg"},je={class:"player-name"},He={class:"action-number"},Ke={class:"panel-container"},Re={class:"action-grid"},We=["onClick"],Xe={class:"btn-text"},Ye={key:0,class:"btn-sub"},Je={class:"panel-container"},Ze={class:"action-grid"},Qe=["onClick"],et={class:"btn-text"},tt={key:0,class:"btn-sub"},st={class:"footer-actions"},P=30,at={__name:"second",setup(ot){const e=ve(),_=m(!1),y=m(!1),E=m(!0),W=[{label:"篮板",type:"teal",key:"rebound"},{label:"助攻",type:"teal",key:"assist"},{label:"盖帽",type:"teal",key:"block"},{label:"抢断",type:"teal",key:"steal"},{label:"暂停",sub:"长按选择时间",type:"teal",key:"timeout"},{label:"二分命中",type:"teal",key:"score2"},{label:"三分命中",type:"teal",key:"score3"},{label:"罚球命中",type:"teal",key:"score1"},{label:"犯规",type:"red",key:"foul"},{label:"技术犯规",type:"red",key:"tech-foul"},{label:"违体",type:"red",key:"unsportsman"},{label:"夺权",type:"red",key:"disqualify"}],X=[{label:"换边",type:"teal",key:"changeSides"},{label:"切换球权",type:"teal",key:"possession"},{label:"打开大屏",type:"teal",key:"open"},{label:"导出比赛数据",type:"teal",key:"exportExcel"},{label:"隐藏人员面板",type:"teal",key:"hide"}],N=a=>{switch(a.key){case"score2":k(2),p.value===1?e.teamA.players[i.value].twoSource++:e.teamB.players[i.value].twoSource++;break;case"score3":k(3),console.log("3分",i.value),p.value===1?e.teamA.players[i.value].threeSource++:(console.log("3分",e.teamB.players),e.teamB.players[i.value].threeSource++);break;case"score1":k(1),p.value===1?e.teamA.players[i.value].oneSource++:e.teamB.players[i.value].oneSource++;break;case"timeout":Q(p.value);break;case"foul":B();break;case"tech-foul":B(),p.value===1?e.teamA.players[i.value].jsfg++:e.teamB.players[i.value].jsfg++;break;case"unsportsman":B(),p.value===1?e.teamA.players[i.value].wt++:e.teamB.players[i.value].wt++;break;case"disqualify":B(),p.value===1?e.teamA.players[i.value].dq++:e.teamB.players[i.value].dq++;break;case"open":se();break;case"hide":E.value=!E.value,b("hide");break;case"possession":A.value=!A.value,b("possession");break;case"changeSides":C.value=!C.value,b("swap");break;case"exportExcel":ae();break}_.value=!1},A=m(!0),C=m(!0);me();const Y=ue();m("wa"),m({name:"XX1队",players:[]}),m({name:"XX2队",players:[]}),m({totalPeriods:4,periodTime:12,breakTime:2,enable24Seconds:!0});const v=m(!0),T=m("playing"),$=m(0),p=m(1),i=m(0),g=m(null);le(()=>{window.addEventListener("keydown",I)}),ne(()=>{window.removeEventListener("keydown",I)});function F(a){if(a<=0)return"00''00''";const s=Math.ceil(a/1e3);if(s>60){const u=Math.floor(s/60).toString().padStart(2,"0"),o=(s%60).toString().padStart(2,"0");return`${u}:${o}`}else{const u=Math.floor(a/1e3).toString().padStart(2,"0"),o=Math.floor(a%1e3/10).toString().padStart(2,"0");return`${u}''${o}''`}}function J(){g.value||(T.value==="ready"&&(T.value="playing"),g.value=setInterval(()=>{T.value==="playing"?v.value?e.timer.periodTime>0?e.timer.periodTime-=P:(e.timer.periodTime=0,S(),e.currentPeriod==e.totalPeriods?alert("比赛结束"):z.alert("本节结束，是否进入场间休息","",{confirmButtonText:"确定",showCancelButton:!1}).then(()=>{e.resetTime(v.value),v.value=!1}).catch(()=>{console.log("用户取消了操作")})):e.timer.breakTime>0?e.timer.breakTime-=P:(e.timer.breakTime=0,S(),z.alert("本节结束，是否进入场间休息","",{confirmButtonText:"确定",showCancelButton:!1}).then(()=>{e.resetTime(v.value),e.addCurrentPeriod(),v.value=!0}).catch(()=>{console.log("用户取消了操作")})):T.value==="resting"&&$.value>0&&($.value-=P)},P))}function S(){clearInterval(g.value),g.value=null}function Z(){g.value?S():J(),b("time")}function G(a,s){p.value=a,i.value=s,_.value=!0}function Q(a){e.addPause(p.value),S(),b("pause",a),b("time")}function k(a){e.addScore(i.value,a,p.value);try{const s=new BroadcastChannel("matchDataChannel"),u=JSON.parse(JSON.stringify(e.$state)),o={type:"scoreAdded",team:p.value,points:a,state:u};s.postMessage(o)}catch(s){console.error("BroadcastChannel Error:",s)}}function B(){e.addFoul(i.value,p.value),b("foul",p.value,i.value)}function b(a,s,u){if(a==="foul")try{const o=new BroadcastChannel("matchDataChannel"),d={type:a,teamFoul:s===1?e.teamA.teamFoul:e.teamB.teamFoul,foul:s===1?e.teamA.players[u].foul:e.teamB.players[u].foul,team:s,sectionFoul:s===1?e.teamA.SectionFouls[e.currentPeriod]:e.teamB.SectionFouls[e.currentPeriod],playIndex:u,currentPeriod:e.currentPeriod};o.postMessage(d)}catch(o){console.error("BroadcastChannel Error:",o)}else if(a==="pause")try{const o=new BroadcastChannel("matchDataChannel"),d={type:a,pause:s===1?e.teamA.teamPauses:e.teamB.teamPauses,team:s};o.postMessage(d)}catch(o){console.error("BroadcastChannel Error:",o)}else if(a==="time")try{const o=new BroadcastChannel("matchDataChannel"),d={type:a,time:!!g.value,timeType:v.value,currentPeriod:e.currentPeriod,periodTime:e.timer.periodTime,breakTime:e.timer.breakTime};o.postMessage(d)}catch(o){console.error("BroadcastChannel Error:",o)}else if(a==="hide")try{const o=new BroadcastChannel("matchDataChannel"),d={type:a,hide:E.value};o.postMessage(d)}catch(o){console.error("BroadcastChannel Error:",o)}else if(a==="possession")try{const o=new BroadcastChannel("matchDataChannel"),d={type:a,possession:A.value};o.postMessage(d)}catch(o){console.error("BroadcastChannel Error:",o)}else if(a==="swap")try{const o=new BroadcastChannel("matchDataChannel"),d={type:a,swap:C.value};o.postMessage(d)}catch(o){console.error("BroadcastChannel Error:",o)}}function ee(){v.value?e.addCurrentPeriod():z.alert("是否结束休息","",{confirmButtonText:"确定",showCancelButton:!1}).then(()=>{e.resetTime(v.value),e.addCurrentPeriod(),S(),b("time"),v.value=!0}).catch(()=>{console.log("用户取消了操作")})}function te(){e.subCurrentPeriod()}function I(a){if(!(a.target.tagName==="INPUT"||a.target.tagName==="TEXTAREA"))switch(a.key.toLowerCase()){case"1":a.preventDefault(),k(1);break;case"2":case"enter":a.preventDefault(),k(2);break;case"3":a.preventDefault(),k(3);break;case"f":a.preventDefault(),B();break;case"g":a.preventDefault();break;case"z":(a.ctrlKey||a.metaKey||!a.ctrlKey&&!a.metaKey)&&a.preventDefault();break;case" ":a.preventDefault();break}}function se(){window.open("#/test","_blank")}function ae(){try{const a=[];a.push(["队伍","号码","姓名","得分","犯规","二分命中次数","三分命中次数","罚球命中次数","篮板","助攻","盖帽","抢断","技术犯规","违体","夺权"]),e.teamA.players.forEach(l=>{a.push([e.teamA.name||"A队",l.number,l.name||"",l.score||0,l.foul||0,l.twoSource||0,l.threeSource||0,l.oneSource||0,l.lb||0,l.zg||0,l.gm||0,l.qd||0,l.jsfg||0,l.wt||0,l.dq||0])}),e.teamB.players.forEach(l=>{a.push([e.teamB.name||"B队",l.number,l.name||"",l.score||0,l.foul||0,l.twoSource||0,l.threeSource||0,l.oneSource||0,l.lb||0,l.zg||0,l.gm||0,l.qd||0,l.jsfg||0,l.wt||0,l.dq||0])});const s=L.aoa_to_sheet(a),u=L.book_new();L.book_append_sheet(u,s,"比赛数据");const d=`比赛数据_${new Date().toISOString().replace(/[:.]/g,"-")}.xlsx`;pe(u,d)}catch{alert("Excel导出失败，请重试")}}function q(){confirm("确定要结束比赛吗？结束后将返回首页。")&&Y.push("/")}return(a,s)=>{var o,d,l,O;const u=de("el-drawer");return w(),f("div",ge,[s[16]||(s[16]=re('<header class="top-nav" data-v-9c9c6bb2><div class="nav-pill" data-v-9c9c6bb2><span class="nav-item active" data-v-9c9c6bb2>比赛</span><span class="nav-item" data-v-9c9c6bb2>工作台</span><span class="nav-item" data-v-9c9c6bb2>我的</span></div></header>',1)),t("div",{class:"sub-header"},[t("span",{class:"back-icon",onClick:q,style:{cursor:"pointer"}},"<"),s[7]||(s[7]=t("h2",{class:"title"},"技术统计",-1)),t("div",{class:"actions"},[s[6]||(s[6]=t("span",{class:"icon"},null,-1)),t("button",{class:"end-btn",onClick:q},"结束")])]),t("div",be,[t("div",ke,r(c(e).teamA.name),1),t("div",_e,[t("p",null,r(String(c(e).teamA.score||0).padStart(2,"0")),1),s[8]||(s[8]=t("p",null,":",-1)),t("p",null,r(String(c(e).teamB.score||0).padStart(2,"0")),1)]),t("div",ye,r(c(e).teamB.name),1)]),t("div",Ce,[t("div",Se,[t("div",Be,[s[9]||(s[9]=t("p",null,"犯规",-1)),t("p",null,r(((o=c(e).teamA.SectionFouls)==null?void 0:o[c(e).currentPeriod])??0),1)]),t("div",Te,[s[10]||(s[10]=t("p",null,"暂停",-1)),t("p",null,r(c(e).teamA.teamPauses),1)])]),t("div",xe,[t("div",De,[t("img",{src:he,alt:"",style:{width:"24px",height:"24px"},onClick:te}),t("div",Pe,[t("div",null,r(v.value?"第"+c(e).currentPeriod+"节":"节间休息"),1),ce(t("div",null,r(((d=c(e).teamA.periodScores)==null?void 0:d[c(e).currentPeriod])??0)+" : "+r(((l=c(e).teamB.periodScores)==null?void 0:l[c(e).currentPeriod])??0),513),[[ie,v.value]])]),t("img",{src:fe,alt:"",style:{width:"24px",height:"24px"},onClick:ee})]),t("div",{class:"time",onClick:Z},[t("div",Ee,[s[11]||(s[11]=t("img",{src:we,alt:""},null,-1)),t("p",{style:V([{color:g.value?"red":"black"},{cursor:"pointer"}])},r(g.value?"暂停计时":"开始计时"),5)]),t("p",Ae,r(v.value?F(c(e).timer.periodTime):F(c(e).timer.breakTime)),1)])]),t("div",Me,[t("div",Ve,[t("p",null,r(((O=c(e).teamB.SectionFouls)==null?void 0:O[c(e).currentPeriod])??0),1),s[12]||(s[12]=t("p",null,"犯规",-1))]),t("div",ze,[t("p",null,r(c(e).teamB.teamPauses),1),s[13]||(s[13]=t("p",null,"暂停",-1))])])]),t("div",Le,[t("div",{class:"team-column",style:V({order:C.value?1:2})},[t("div",Ne,[(w(!0),f(x,null,D(c(e).teamA.players,(n,h)=>(w(),f("div",{key:h,class:"player-card",onClick:M=>G(1,h)},[t("div",Fe,r(n.number),1),t("div",Ge,r(n.name),1),t("div",null,[s[14]||(s[14]=t("img",{src:R,alt:"",class:"action-btn"},null,-1)),t("p",Ie,r(n.number),1)])],8,$e))),128))])],4),t("div",{class:"team-column",style:V({order:C.value?2:1})},[t("div",qe,[(w(!0),f(x,null,D(c(e).teamB.players,(n,h)=>(w(),f("div",{key:h,class:"player-card",onClick:M=>G(2,h)},[t("div",Ue,r(n.number),1),t("div",je,r(n.name),1),t("div",null,[s[15]||(s[15]=t("img",{src:R,alt:"",class:"action-btn"},null,-1)),t("p",He,r(n.number),1)])],8,Oe))),128))])],4)]),U(u,{modelValue:_.value,"onUpdate:modelValue":s[1]||(s[1]=n=>_.value=n),direction:"btt",size:"auto","with-header":!1,class:"action-drawer"},{default:j(()=>[t("div",Ke,[t("div",{class:"drag-handle",onClick:s[0]||(s[0]=n=>_.value=!1)}),t("div",Re,[(w(),f(x,null,D(W,(n,h)=>t("div",{key:h,class:H(["grid-item",n.type]),onClick:M=>N(n)},[t("span",Xe,r(n.label),1),n.sub?(w(),f("span",Ye,r(n.sub),1)):K("",!0)],10,We)),64))])])]),_:1},8,["modelValue"]),U(u,{modelValue:y.value,"onUpdate:modelValue":s[3]||(s[3]=n=>y.value=n),direction:"btt",size:"auto","with-header":!1,class:"action-drawer"},{default:j(()=>[t("div",Je,[t("div",{class:"drag-handle",onClick:s[2]||(s[2]=n=>y.value=!1)}),t("div",Ze,[(w(),f(x,null,D(X,(n,h)=>t("div",{key:h,class:H(["grid-item",n.type]),onClick:M=>N(n)},[t("span",et,r(n.label),1),n.sub?(w(),f("span",tt,r(n.sub),1)):K("",!0)],10,Qe)),64))])])]),_:1},8,["modelValue"]),t("footer",st,[t("button",{class:"add-btn left",onClick:s[4]||(s[4]=n=>y.value=!0)},"+"),t("button",{class:"add-btn right dark",onClick:s[5]||(s[5]=n=>y.value=!0)},"+")])])}}},ct=oe(at,[["__scopeId","data-v-9c9c6bb2"]]);export{ct as default};
