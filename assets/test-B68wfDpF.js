import{_ as S,r as c,h as A,i as N,j as b,c as p,o as h,b as s,k as y,t as o}from"./index-C1EvLQdv.js";const D={class:"background"},k={class:"vice-panel"},x={class:"vice-teams"},C={class:"vice-team"},I={class:"vice-team-name team-a"},w={class:"vice-score"},U={class:"vice-team"},J={class:"vice-team-name team-b"},O={class:"vice-score"},M={class:"vice-timer-section"},V={class:"vice-period"},$={class:"vice-main-timer"},j={key:0,class:"vice-24s-section"},q={class:"vice-24s"},E={key:1,class:"vice-rest"},R={class:"rest-text",style:{color:"#49ddfa"}},z={__name:"test",setup(F){const B=N(),t=c(null),i=c({name:"",score:0}),l=c({name:"",score:0}),v=c(1),u=c(12*60),f=c(22),d=c(0),m=c("playing");function g(n){const e=String(Math.floor(n/60)).padStart(2,"0"),a=String(n%60).padStart(2,"0");return`${e}:${a}`}let _=null,r=null;A(()=>{const n=B.query.data;if(n)try{t.value=JSON.parse(n),t.value.teamA&&(i.value.name=t.value.teamA.name||"",t.value.teamA.score!==void 0&&(i.value.score=t.value.teamA.score)),t.value.teamB&&(l.value.name=t.value.teamB.name||"",t.value.teamB.score!==void 0&&(l.value.score=t.value.teamB.score)),t.value.settings&&(u.value=t.value.settings.periodTime*60),t.value.matchName&&(document.title=t.value.matchName)}catch(e){console.error("解析数据失败:",e)}_=setInterval(()=>{T()},100);try{r=new BroadcastChannel("matchDataChannel"),r.onmessage=e=>{if(e.data.type==="dataUpdated"){const a=e.data.data;a.teamA&&(i.value.name=a.teamA.name||i.value.name,a.teamA.score!==void 0&&(i.value.score=a.teamA.score)),a.teamB&&(l.value.name=a.teamB.name||l.value.name,a.teamB.score!==void 0&&(l.value.score=a.teamB.score)),a.playNumber!==void 0&&(v.value=a.playNumber),a.mainTime!==void 0&&(u.value=a.mainTime),a.smallTime!==void 0&&(f.value=a.smallTime),a.restTime!==void 0&&(d.value=a.restTime),a.gameStatus!==void 0&&(m.value=a.gameStatus),t.value=a}}}catch{console.log("BroadcastChannel not supported")}});function T(){try{const n=localStorage.getItem("matchSyncData");if(n&&n!==JSON.stringify(t.value))try{const e=JSON.parse(n);e.teamA&&(i.value.name=e.teamA.name||i.value.name,e.teamA.score!==void 0&&(i.value.score=e.teamA.score)),e.teamB&&(l.value.name=e.teamB.name||l.value.name,e.teamB.score!==void 0&&(l.value.score=e.teamB.score)),e.playNumber!==void 0&&(v.value=e.playNumber),e.mainTime!==void 0&&(u.value=e.mainTime),e.smallTime!==void 0&&(f.value=e.smallTime),e.restTime!==void 0&&(d.value=e.restTime),e.gameStatus!==void 0&&(m.value=e.gameStatus),t.value=e}catch(e){console.error("更新数据失败:",e)}}catch(n){console.error("检查数据更新失败:",n)}}return b(()=>{_&&clearInterval(_),r&&(r.close(),r=null)}),(n,e)=>(h(),p("div",D,[s("div",k,[e[2]||(e[2]=s("div",{class:"vice-title"},"队伍",-1)),s("div",x,[s("div",C,[s("div",I,o(i.value.name),1),s("div",w,o(i.value.score),1)]),e[0]||(e[0]=s("div",{style:{width:"38px"}},null,-1)),s("div",U,[s("div",J,o(l.value.name),1),s("div",O,o(l.value.score),1)])]),s("div",M,[s("span",V,"第"+o(v.value)+"节"+o(m.value==="resting"?"休息":"比赛"),1),s("span",$,o(g(m.value==="resting"?d.value:u.value)),1)]),m.value!=="resting"?(h(),p("div",j,[e[1]||(e[1]=s("span",{class:"vice-24s-label"},"24秒",-1)),s("span",q,o(f.value),1)])):y("",!0),m.value==="resting"?(h(),p("div",E,[s("span",R,"节间休息："+o(g(d.value)),1)])):y("",!0)])]))}},H=S(z,[["__scopeId","data-v-8cb54acd"]]);export{H as default};
