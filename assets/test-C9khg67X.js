import{_ as N}from"./jiantou-D-2Ruc_p.js";import{_ as E,r as o,v as j,c as f,o as m,b as a,t as c,F as U,f as V,h as K,i as Q,j as X,k as S,n as d,d as z,l as J}from"./index-C4xfRVK2.js";import{F as O}from"./FlipDigit-D6j6l6oA.js";const Y={class:"scoreboard"},Z={class:"title-container"},ee={class:"title"},ae={class:"players-container"},te={class:"score-table"},se={__name:"teamPk",props:{customPlayers:{type:Array,default:null},teamName:{type:String,default:""}},setup($){const x=$,s=o([{id:0,name:"0",score:0,foul:0}]),u=j(()=>x.customPlayers||s.value);return(r,_)=>(m(),f("div",Y,[a("div",Z,[a("h2",ee,c($.teamName),1)]),a("div",ae,[a("table",te,[_[0]||(_[0]=a("thead",null,[a("tr",null,[a("th",null,"号码"),a("th",null,"姓名"),a("th",null,"得分"),a("th",null,"犯规")])],-1)),a("tbody",null,[(m(!0),f(U,null,V(u.value,p=>(m(),f("tr",{key:p.id},[a("td",null,c(p.id),1),a("td",null,c(p.name),1),a("td",null,c(p.score),1),a("td",null,c(p.foul),1)]))),128))])])])]))}},R=E(se,[["__scopeId","data-v-0c8828b0"]]),M=""+new URL("logo-Bv1Wukfg.png",import.meta.url).href,le={class:"background"},ne={class:"center-panel",style:{order:"2"}},oe={class:"vice-panel"},ue={class:"match-info-container"},re={class:"teams-info"},ie={class:"team-logo team-a"},me=["src"],ce={class:"flip-wrapper",style:{"margin-top":"14px"}},de={class:"period-info",style:{order:"2"}},ve={class:"period-number"},fe={class:"period-status"},pe={class:"team-logo team-b"},ye=["src","alt"],ge={class:"flip-wrapper",style:{"margin-top":"14px"}},_e={class:"stats-container"},he={class:"stat-row"},Be={class:"stat-row"},Se={key:0,class:"vice-24s-section"},be={class:"vice-24s"},Ae={key:1,class:"vice-rest"},we={class:"rest-text",style:{color:"#49ddfa"}},Te={key:2,class:"vice-end"},Pe={__name:"test",setup($){const x=Q(),s=o(null),u=o({name:"",score:0,players:[]}),r=o({name:"",score:0,players:[]}),_=o(1),p=o(12*60),D=o(22),b=o(0),y=o("playing"),A=o(!0),w=o(0),T=o(0),P=o(0),k=o(0),g=o(!0),v=o(!0),h=o(!0),W=j(()=>localStorage.getItem("teamALogo")||M),G=j(()=>localStorage.getItem("teamBLogo")||M);function F(i){const e=String(Math.floor(i/60)).padStart(2,"0"),l=String(i%60).padStart(2,"0");return`${e}:${l}`}let I=null,B=null;K(()=>{const i=x.query.data;if(i)try{s.value=JSON.parse(i),s.value.teamA&&(u.value.name=s.value.teamA.name||"",s.value.teamA.score!==void 0&&(u.value.score=s.value.teamA.score),s.value.teamA.players&&(u.value.players=s.value.teamA.players)),s.value.teamB&&(r.value.name=s.value.teamB.name||"",s.value.teamB.score!==void 0&&(r.value.score=s.value.teamB.score),s.value.teamB.players&&(r.value.players=s.value.teamB.players)),s.value.settings&&(p.value=s.value.settings.periodTime*60,A.value=s.value.settings.enable24Seconds||!1),s.value.matchName&&(document.title=s.value.matchName),s.value.showTeamPanels!==void 0&&(g.value=s.value.showTeamPanels)}catch(n){console.error("解析数据失败:",n)}const e=localStorage.getItem("showTeamPanels");e!==null&&(g.value=e==="true");const l=localStorage.getItem("swap");l!==null&&(v.value=l==="true"),I=setInterval(()=>{H()},100);try{B=new BroadcastChannel("matchDataChannel"),B.onmessage=n=>{if(n.data.type==="dataUpdated"){const t=n.data.data;t.teamA&&(u.value.name=t.teamA.name||u.value.name,t.teamA.score!==void 0&&(u.value.score=t.teamA.score),t.teamA.players&&(u.value.players=t.teamA.players)),t.teamB&&(r.value.name=t.teamB.name||r.value.name,t.teamB.score!==void 0&&(r.value.score=t.teamB.score),t.teamB.players&&(r.value.players=t.teamB.players)),t.playNumber!==void 0&&(_.value=t.playNumber),t.mainTime!==void 0&&(p.value=t.mainTime),t.smallTime!==void 0&&(D.value=t.smallTime),t.restTime!==void 0&&(b.value=t.restTime),t.gameStatus!==void 0&&(y.value=t.gameStatus),t.settings&&t.settings.enable24Seconds!==void 0&&(A.value=t.settings.enable24Seconds),t.teamAPauses!==void 0&&(w.value=t.teamAPauses),t.teamBPauses!==void 0&&(T.value=t.teamBPauses),t.teamA&&t.teamA.players&&(P.value=t.teamA.players.reduce((L,C)=>L+(C.foul||0),0)),t.teamB&&t.teamB.players&&(k.value=t.teamB.players.reduce((L,C)=>L+(C.foul||0),0)),t.showTeamPanels!==void 0&&(g.value=t.showTeamPanels),t.swap!==void 0&&(v.value=t.swap),t.jiantou!==void 0&&(h.value=t.jiantou),s.value=t}else n.data.type==="toggleTeamPanels"?g.value=n.data.show:n.data.type==="swapTeams"?v.value=n.data.swapped:n.data.type==="possessionChanged"&&(h.value=n.data.jiantou)}}catch{console.log("BroadcastChannel not supported")}});function H(){try{const i=localStorage.getItem("matchSyncData");if(i&&i!==JSON.stringify(s.value))try{const e=JSON.parse(i);e.teamA&&(u.value.name=e.teamA.name||u.value.name,e.teamA.score!==void 0&&(u.value.score=e.teamA.score),e.teamA.players&&(u.value.players=e.teamA.players)),e.teamB&&(r.value.name=e.teamB.name||r.value.name,e.teamB.score!==void 0&&(r.value.score=e.teamB.score),e.teamB.players&&(r.value.players=e.teamB.players)),e.playNumber!==void 0&&(_.value=e.playNumber),e.mainTime!==void 0&&(p.value=e.mainTime),e.smallTime!==void 0&&(D.value=e.smallTime),e.restTime!==void 0&&(b.value=e.restTime),e.gameStatus!==void 0&&(y.value=e.gameStatus),e.settings&&e.settings.enable24Seconds!==void 0&&(A.value=e.settings.enable24Seconds),e.teamAPauses!==void 0&&(w.value=e.teamAPauses),e.teamBPauses!==void 0&&(T.value=e.teamBPauses),e.teamA&&e.teamA.players&&(P.value=e.teamA.players.reduce((l,n)=>l+(n.foul||0),0)),e.teamB&&e.teamB.players&&(k.value=e.teamB.players.reduce((l,n)=>l+(n.foul||0),0)),e.showTeamPanels!==void 0&&(g.value=e.showTeamPanels),s.value=e}catch(e){console.error("更新数据失败:",e)}}catch(i){console.error("检查数据更新失败:",i)}}X(()=>{I&&clearInterval(I),B&&(B.close(),B=null)});function q(i){const e=String(i).padStart(2,"0");return console.log(`Formatted score: ${i} -> [${e[0]}, ${e[1]}, ${e[2]}]`),[e[0],e[1]]}return(i,e)=>(m(),f("div",le,[g.value?(m(),f("div",{key:0,class:"team-info-panel team-a-panel",style:d({order:v.value?1:3})},[z(R,{"custom-players":u.value.players.map(l=>({id:l.number||"0",name:l.name||"未知",score:l.score||0,foul:l.foul||0})),"team-name":u.value.name||"队伍A"},null,8,["custom-players","team-name"])],4)):S("",!0),a("div",ne,[a("div",oe,[e[5]||(e[5]=a("div",{class:"vice-title qiuquan"},null,-1)),a("div",ue,[a("div",re,[a("div",{class:"team-info teamLeft",style:d({order:v.value?1:3})},[a("img",{src:N,alt:"箭头",style:d({opacity:h.value?1:0})},null,4),a("div",ie,[a("img",{src:N,alt:"箭头",class:"logo-arrow",style:d({opacity:h.value?0:1})},null,4),a("img",{src:W.value,class:"circular-image"},null,8,me)]),a("div",ce,[(m(!0),f(U,null,V(q(u.value.score),(l,n)=>(m(),J(O,{key:"a"+n,number:l.toString()},null,8,["number"]))),128))])],4),a("div",de,[a("div",ve,"第"+c(_.value)+"节",1),a("div",fe,c(y.value==="resting"?F(b.value):y.value==="ended"?"结束":F(p.value)),1),e[0]||(e[0]=a("div",{class:"VS",style:{position:"relative","font-size":"100px",top:"140px"}}," VS ",-1))]),a("div",{class:"team-info teamRight",style:d({order:v.value?3:1})},[a("img",{src:N,alt:"箭头",style:d({opacity:h.value?0:1})},null,4),a("div",pe,[a("img",{src:N,alt:"箭头",class:"logo-arrow",style:d({opacity:h.value?1:0})},null,4),a("img",{src:G.value,alt:r.value.name,class:"circular-image"},null,8,ye)]),a("div",ge,[(m(!0),f(U,null,V(q(r.value.score),(l,n)=>(m(),J(O,{key:"b"+n,number:l.toString()},null,8,["number"]))),128))])],4)]),a("div",_e,[a("div",he,[a("div",{class:"team-stat team-a",style:d({order:v.value?1:3})},c(w.value===0?"F":w.value),5),e[1]||(e[1]=a("div",{class:"stat-label",style:{order:"2"}},"暂停",-1)),a("div",{class:"team-stat team-b",style:d({order:v.value?3:1})},c(T.value===0?"F":T.value),5)]),a("div",Be,[a("div",{class:"team-stat team-a",style:d({order:v.value?1:3})},c(P.value===0?"F":P.value),5),e[2]||(e[2]=a("div",{class:"stat-label",style:{order:"2"}},"犯规",-1)),a("div",{class:"team-stat team-b",style:d({order:v.value?3:1})},c(k.value===0?"F":k.value),5)])])]),y.value!=="resting"&&y.value!=="ended"&&A.value?(m(),f("div",Se,[e[3]||(e[3]=a("span",{class:"vice-24s-label"},"24秒",-1)),a("span",be,c(D.value),1)])):S("",!0),y.value==="resting"?(m(),f("div",Ae,[a("span",we,"节间休息："+c(F(b.value)),1)])):S("",!0),y.value==="ended"?(m(),f("div",Te,[...e[4]||(e[4]=[a("span",{class:"end-text",style:{color:"#ff6b6b","font-size":"40px","font-weight":"bold"}},"比赛结束",-1)])])):S("",!0)])]),g.value?(m(),f("div",{key:1,class:"team-info-panel team-b-panel",style:d({order:v.value?3:1})},[z(R,{"custom-players":r.value.players.map(l=>({id:l.number||"0",name:l.name||"未知",score:l.score||0,foul:l.foul||0})),"team-name":r.value.name||"队伍B"},null,8,["custom-players","team-name"])],4)):S("",!0)]))}},xe=E(Pe,[["__scopeId","data-v-45c3403e"]]);export{xe as default};
