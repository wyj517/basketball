import{_ as C}from"./jiantou-Bvhfw6dr.js";import{_ as J,r as n,y as z,c as d,o as r,b as a,t as c,F as S,f as A,j as Q,m as T,w as te,h as b,p as v,T as se,k as le,l as ne,d as R}from"./index-lGCosI-d.js";import{F as W}from"./FlipDigit-CfKKdjuH.js";const oe={class:"scoreboard"},ue={class:"title-container"},re={class:"title"},ie={class:"players-container"},me={class:"score-table"},de={__name:"teamPk",props:{customPlayers:{type:Array,default:null},teamName:{type:String,default:""}},setup(g){const B=g,s=n([{id:0,name:"0",score:0,foul:0}]),i=z(()=>B.customPlayers||s.value);return(o,_)=>(r(),d("div",oe,[a("div",ue,[a("h2",re,c(g.teamName),1)]),a("div",ie,[a("table",me,[_[0]||(_[0]=a("thead",null,[a("tr",null,[a("th",null,"号码"),a("th",null,"姓名"),a("th",null,"得分"),a("th",null,"犯规")])],-1)),a("tbody",null,[(r(!0),d(S,null,A(i.value,p=>(r(),d("tr",{key:p.id},[a("td",null,c(p.id),1),a("td",null,c(p.name),1),a("td",null,c(p.score),1),a("td",null,c(p.foul),1)]))),128))])])])]))}},G=J(de,[["__scopeId","data-v-0c8828b0"]]),H=""+new URL("logo-Bv1Wukfg.png",import.meta.url).href,ce={__name:"FloatNumber",props:{value:{type:Number,required:!0},x:{type:Number,default:0},duration:{type:Number,default:1e3}},setup(g){const B=g,s=n(!0);return Q(()=>{setTimeout(()=>{s.value=!1},B.duration)}),(i,o)=>(r(),T(se,{name:"float",onAfterLeave:o[0]||(o[0]=_=>i.$emit("end"))},{default:te(()=>[s.value?(r(),d("div",{key:0,class:"float-number",style:v({left:g.x+"px"})}," +"+c(g.value),5)):b("",!0)]),_:1}))}},K=J(ce,[["__scopeId","data-v-ec00c89c"]]),ve={class:"background"},fe={class:"center-panel",style:{order:"2"}},pe={class:"vice-panel"},ye={class:"match-info-container"},ge={class:"teams-info"},_e={class:"team-logo team-a"},we=["src"],he={class:"float-container"},be={class:"flip-wrapper",style:{"margin-top":"14px"}},Be={class:"period-info",style:{order:"2"}},De={class:"period-number"},Se={class:"period-status"},Ae={class:"team-logo team-b"},Te=["src","alt"],Pe={class:"float-container"},Ne={class:"flip-wrapper",style:{"margin-top":"14px"}},xe={class:"stats-container"},ke={class:"stat-row"},$e={class:"stat-row"},Fe={key:0,class:"vice-24s-section"},Ie={class:"vice-24s"},Le={key:1,class:"vice-rest"},Ce={class:"rest-text",style:{color:"#49ddfa"}},je={key:2,class:"vice-end"},Ee={__name:"test",setup(g){const B=le(),s=n(null),i=n({name:"",score:0,players:[]}),o=n({name:"",score:0,players:[]}),_=n(1),p=n(12*60),j=n(22),P=n(0),y=n("playing"),N=n(!0),x=n(0),k=n(0),$=n(0),F=n(0),w=n(!0);let X=0;const I=n([]),L=n([]),Y=(u,e)=>{const t={id:X++,value:e,x:Math.random()*100};u===1?I.value.push(t):L.value.push(t)},M=(u,e)=>{u===1?I.value=I.value.filter(t=>t.id!==e):L.value=L.value.filter(t=>t.id!==e)},f=n(!0),h=n(!0),Z=z(()=>localStorage.getItem("teamALogo")||H),ee=z(()=>localStorage.getItem("teamBLogo")||H);function E(u){const e=String(Math.floor(u/60)).padStart(2,"0"),t=String(u%60).padStart(2,"0");return`${e}:${t}`}let U=null,D=null;Q(()=>{const u=B.query.data;if(u)try{s.value=JSON.parse(u),s.value.teamA&&(i.value.name=s.value.teamA.name||"",s.value.teamA.score!==void 0&&(i.value.score=s.value.teamA.score),s.value.teamA.players&&(i.value.players=s.value.teamA.players)),s.value.teamB&&(o.value.name=s.value.teamB.name||"",s.value.teamB.score!==void 0&&(o.value.score=s.value.teamB.score),s.value.teamB.players&&(o.value.players=s.value.teamB.players)),s.value.settings&&(p.value=s.value.settings.periodTime*60,N.value=s.value.settings.enable24Seconds||!1),s.value.matchName&&(document.title=s.value.matchName),s.value.showTeamPanels!==void 0&&(w.value=s.value.showTeamPanels)}catch(l){console.error("解析数据失败:",l)}const e=localStorage.getItem("showTeamPanels");e!==null&&(w.value=e==="true");const t=localStorage.getItem("swap");t!==null&&(f.value=t==="true"),U=setInterval(()=>{ae()},100);try{D=new BroadcastChannel("matchDataChannel"),D.onmessage=l=>{if(l.data.type==="dataUpdated"){const m=l.data.data;m.teamA&&(i.value.name=m.teamA.name||i.value.name,m.teamA.score!==void 0&&(i.value.score=m.teamA.score),m.teamA.players&&(i.value.players=m.teamA.players)),m.teamB&&(o.value.name=m.teamB.name||o.value.name,m.teamB.score!==void 0&&(o.value.score=m.teamB.score),m.teamB.players&&(o.value.players=m.teamB.players))}else if(l.data.type==="scoreAdded"){const m=l.data;Y(m.team,m.points),newData.playNumber!==void 0&&(_.value=newData.playNumber),newData.mainTime!==void 0&&(p.value=newData.mainTime),newData.smallTime!==void 0&&(j.value=newData.smallTime),newData.restTime!==void 0&&(P.value=newData.restTime),newData.gameStatus!==void 0&&(y.value=newData.gameStatus),newData.settings&&newData.settings.enable24Seconds!==void 0&&(N.value=newData.settings.enable24Seconds),newData.teamAPauses!==void 0&&(x.value=newData.teamAPauses),newData.teamBPauses!==void 0&&(k.value=newData.teamBPauses),newData.teamA&&newData.teamA.players&&($.value=newData.teamA.players.reduce((V,q)=>V+(q.foul||0),0)),newData.teamB&&newData.teamB.players&&(F.value=newData.teamB.players.reduce((V,q)=>V+(q.foul||0),0)),newData.showTeamPanels!==void 0&&(w.value=newData.showTeamPanels),newData.swap!==void 0&&(f.value=newData.swap),newData.jiantou!==void 0&&(h.value=newData.jiantou),s.value=newData}else l.data.type==="toggleTeamPanels"?w.value=l.data.show:l.data.type==="swapTeams"?f.value=l.data.swapped:l.data.type==="possessionChanged"&&(h.value=l.data.jiantou)}}catch{console.log("BroadcastChannel not supported")}});function ae(){try{const u=localStorage.getItem("matchSyncData");if(u&&u!==JSON.stringify(s.value))try{const e=JSON.parse(u);e.teamA&&(i.value.name=e.teamA.name||i.value.name,e.teamA.score!==void 0&&(i.value.score=e.teamA.score),e.teamA.players&&(i.value.players=e.teamA.players)),e.teamB&&(o.value.name=e.teamB.name||o.value.name,e.teamB.score!==void 0&&(o.value.score=e.teamB.score),e.teamB.players&&(o.value.players=e.teamB.players)),e.playNumber!==void 0&&(_.value=e.playNumber),e.mainTime!==void 0&&(p.value=e.mainTime),e.smallTime!==void 0&&(j.value=e.smallTime),e.restTime!==void 0&&(P.value=e.restTime),e.gameStatus!==void 0&&(y.value=e.gameStatus),e.settings&&e.settings.enable24Seconds!==void 0&&(N.value=e.settings.enable24Seconds),e.teamAPauses!==void 0&&(x.value=e.teamAPauses),e.teamBPauses!==void 0&&(k.value=e.teamBPauses),e.teamA&&e.teamA.players&&($.value=e.teamA.players.reduce((t,l)=>t+(l.foul||0),0)),e.teamB&&e.teamB.players&&(F.value=e.teamB.players.reduce((t,l)=>t+(l.foul||0),0)),e.showTeamPanels!==void 0&&(w.value=e.showTeamPanels),s.value=e}catch(e){console.error("更新数据失败:",e)}}catch(u){console.error("检查数据更新失败:",u)}}ne(()=>{U&&clearInterval(U),D&&(D.close(),D=null)});function O(u){const e=String(u).padStart(2,"0");return console.log(`Formatted score: ${u} -> [${e[0]}, ${e[1]}, ${e[2]}]`),[e[0],e[1]]}return(u,e)=>(r(),d("div",ve,[w.value?(r(),d("div",{key:0,class:"team-info-panel team-a-panel",style:v({order:f.value?1:3})},[R(G,{"custom-players":i.value.players.map(t=>({id:t.number||"0",name:t.name||"未知",score:t.score||0,foul:t.foul||0})),"team-name":i.value.name||"队伍A"},null,8,["custom-players","team-name"])],4)):b("",!0),a("div",fe,[a("div",pe,[e[5]||(e[5]=a("div",{class:"vice-title qiuquan"},null,-1)),a("div",ye,[a("div",ge,[a("div",{class:"team-info teamLeft",style:v({order:f.value?1:3})},[a("img",{src:C,alt:"箭头",style:v({opacity:h.value?1:0})},null,4),a("div",_e,[a("img",{src:C,alt:"箭头",class:"logo-arrow",style:v({opacity:h.value?0:1})},null,4),a("img",{src:Z.value,class:"circular-image"},null,8,we)]),a("div",he,[(r(!0),d(S,null,A(I.value,t=>(r(),T(K,{key:t.id,value:t.value,x:t.x,duration:20,onEnd:l=>M(1,t.id)},null,8,["value","x","onEnd"]))),128))]),a("div",be,[(r(!0),d(S,null,A(O(i.value.score),(t,l)=>(r(),T(W,{key:"a"+l,number:t.toString()},null,8,["number"]))),128))])],4),a("div",Be,[a("div",De,"第"+c(_.value)+"节",1),a("div",Se,c(y.value==="resting"?E(P.value):y.value==="ended"?"结束":E(p.value)),1),e[0]||(e[0]=a("div",{class:"VS",style:{position:"relative","font-size":"100px",top:"140px"}}," VS ",-1))]),a("div",{class:"team-info teamRight",style:v({order:f.value?3:1})},[a("img",{src:C,alt:"箭头",style:v({opacity:h.value?0:1})},null,4),a("div",Ae,[a("img",{src:C,alt:"箭头",class:"logo-arrow",style:v({opacity:h.value?1:0})},null,4),a("img",{src:ee.value,alt:o.value.name,class:"circular-image"},null,8,Te)]),a("div",Pe,[(r(!0),d(S,null,A(L.value,t=>(r(),T(K,{key:t.id,value:t.value,x:t.x,duration:20,onEnd:l=>M(2,t.id)},null,8,["value","x","onEnd"]))),128))]),a("div",Ne,[(r(!0),d(S,null,A(O(o.value.score),(t,l)=>(r(),T(W,{key:"b"+l,number:t.toString()},null,8,["number"]))),128))])],4)]),a("div",xe,[a("div",ke,[a("div",{class:"team-stat team-a",style:v({order:f.value?1:3})},c(x.value===0?"F":x.value),5),e[1]||(e[1]=a("div",{class:"stat-label",style:{order:"2"}},"暂停",-1)),a("div",{class:"team-stat team-b",style:v({order:f.value?3:1})},c(k.value===0?"F":k.value),5)]),a("div",$e,[a("div",{class:"team-stat team-a",style:v({order:f.value?1:3})},c($.value===0?"F":$.value),5),e[2]||(e[2]=a("div",{class:"stat-label",style:{order:"2"}},"犯规",-1)),a("div",{class:"team-stat team-b",style:v({order:f.value?3:1})},c(F.value===0?"F":F.value),5)])])]),y.value!=="resting"&&y.value!=="ended"&&N.value?(r(),d("div",Fe,[e[3]||(e[3]=a("span",{class:"vice-24s-label"},"24秒",-1)),a("span",Ie,c(j.value),1)])):b("",!0),y.value==="resting"?(r(),d("div",Le,[a("span",Ce,"节间休息："+c(E(P.value)),1)])):b("",!0),y.value==="ended"?(r(),d("div",je,[...e[4]||(e[4]=[a("span",{class:"end-text",style:{color:"#ff6b6b","font-size":"40px","font-weight":"bold"}},"比赛结束",-1)])])):b("",!0)])]),w.value?(r(),d("div",{key:1,class:"team-info-panel team-b-panel",style:v({order:f.value?3:1})},[R(G,{"custom-players":o.value.players.map(t=>({id:t.number||"0",name:t.name||"未知",score:t.score||0,foul:t.foul||0})),"team-name":o.value.name||"队伍B"},null,8,["custom-players","team-name"])],4)):b("",!0)]))}},ze=J(Ee,[["__scopeId","data-v-003241a3"]]);export{ze as default};
