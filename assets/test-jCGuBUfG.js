import{_ as w,r as o,h as $,i as C,j as F,c,o as u,b as s,k as S,t as m,F as A,f as T,l as k}from"./index-BhItg0js.js";import{F as N}from"./FlipDigit-B-X8Gbl0.js";const I={class:"background"},U={class:"vice-panel"},J={class:"vice-teams"},O={class:"vice-team"},M={class:"vice-team-name team-a"},V={class:"flip-wrapper",style:{"margin-top":"14px"}},j={class:"vice-team"},q={class:"vice-team-name team-b"},z={class:"flip-wrapper",style:{"margin-top":"14px"}},E={class:"vice-timer-section"},L={class:"vice-period"},R={class:"vice-main-timer"},G={key:0,class:"vice-24s-section"},H={class:"vice-24s"},K={key:1,class:"vice-rest"},P={class:"rest-text",style:{color:"#49ddfa"}},Q={key:2,class:"vice-end"},W={__name:"test",setup(X){const D=C(),t=o(null),l=o({name:"",score:0,players:[]}),i=o({name:"",score:0,players:[]}),y=o(1),v=o(12*60),_=o(22),f=o(0),r=o("playing"),p=o(!0);function B(n){const e=String(Math.floor(n/60)).padStart(2,"0"),a=String(n%60).padStart(2,"0");return`${e}:${a}`}let g=null,d=null;$(()=>{const n=D.query.data;if(n)try{t.value=JSON.parse(n),t.value.teamA&&(l.value.name=t.value.teamA.name||"",t.value.teamA.score!==void 0&&(l.value.score=t.value.teamA.score),t.value.teamA.players&&(l.value.players=t.value.teamA.players)),t.value.teamB&&(i.value.name=t.value.teamB.name||"",t.value.teamB.score!==void 0&&(i.value.score=t.value.teamB.score),t.value.teamB.players&&(i.value.players=t.value.teamB.players)),t.value.settings&&(v.value=t.value.settings.periodTime*60,p.value=t.value.settings.enable24Seconds||!1),t.value.matchName&&(document.title=t.value.matchName)}catch(e){console.error("解析数据失败:",e)}g=setInterval(()=>{x()},100);try{d=new BroadcastChannel("matchDataChannel"),d.onmessage=e=>{if(e.data.type==="dataUpdated"){const a=e.data.data;a.teamA&&(l.value.name=a.teamA.name||l.value.name,a.teamA.score!==void 0&&(l.value.score=a.teamA.score),a.teamA.players&&(l.value.players=a.teamA.players)),a.teamB&&(i.value.name=a.teamB.name||i.value.name,a.teamB.score!==void 0&&(i.value.score=a.teamB.score),a.teamB.players&&(i.value.players=a.teamB.players)),a.playNumber!==void 0&&(y.value=a.playNumber),a.mainTime!==void 0&&(v.value=a.mainTime),a.smallTime!==void 0&&(_.value=a.smallTime),a.restTime!==void 0&&(f.value=a.restTime),a.gameStatus!==void 0&&(r.value=a.gameStatus),a.settings&&a.settings.enable24Seconds!==void 0&&(p.value=a.settings.enable24Seconds),t.value=a}}}catch{console.log("BroadcastChannel not supported")}});function x(){try{const n=localStorage.getItem("matchSyncData");if(n&&n!==JSON.stringify(t.value))try{const e=JSON.parse(n);e.teamA&&(l.value.name=e.teamA.name||l.value.name,e.teamA.score!==void 0&&(l.value.score=e.teamA.score),e.teamA.players&&(l.value.players=e.teamA.players)),e.teamB&&(i.value.name=e.teamB.name||i.value.name,e.teamB.score!==void 0&&(i.value.score=e.teamB.score),e.teamB.players&&(i.value.players=e.teamB.players)),e.playNumber!==void 0&&(y.value=e.playNumber),e.mainTime!==void 0&&(v.value=e.mainTime),e.smallTime!==void 0&&(_.value=e.smallTime),e.restTime!==void 0&&(f.value=e.restTime),e.gameStatus!==void 0&&(r.value=e.gameStatus),e.settings&&e.settings.enable24Seconds!==void 0&&(p.value=e.settings.enable24Seconds),t.value=e}catch(e){console.error("更新数据失败:",e)}}catch(n){console.error("检查数据更新失败:",n)}}F(()=>{g&&clearInterval(g),d&&(d.close(),d=null)});function b(n){const e=String(n).padStart(3,"0");return console.log(`Formatted score: ${n} -> [${e[0]}, ${e[1]}, ${e[2]}]`),[e[0],e[1],e[2]]}return(n,e)=>(u(),c("div",I,[s("div",U,[e[3]||(e[3]=s("div",{class:"vice-title"},null,-1)),s("div",J,[s("div",O,[s("div",M,m(l.value.name),1),s("div",V,[(u(!0),c(A,null,T(b(l.value.score),(a,h)=>(u(),k(N,{key:"a"+h,number:a.toString()},null,8,["number"]))),128))])]),e[0]||(e[0]=s("div",{style:{width:"38px"}},null,-1)),s("div",j,[s("div",q,m(i.value.name),1),s("div",z,[(u(!0),c(A,null,T(b(i.value.score),(a,h)=>(u(),k(N,{key:"b"+h,number:a.toString()},null,8,["number"]))),128))])])]),s("div",E,[s("span",L,"第"+m(y.value)+"节"+m(r.value==="resting"?"休息":r.value==="ended"?"比赛结束":"比赛"),1),s("span",R,m(B(r.value==="resting"?f.value:v.value)),1)]),r.value!=="resting"&&r.value!=="ended"&&p.value?(u(),c("div",G,[e[1]||(e[1]=s("span",{class:"vice-24s-label"},"24秒",-1)),s("span",H,m(_.value),1)])):S("",!0),r.value==="resting"?(u(),c("div",K,[s("span",P,"节间休息："+m(B(f.value)),1)])):S("",!0),r.value==="ended"?(u(),c("div",Q,[...e[2]||(e[2]=[s("span",{class:"end-text",style:{color:"#ff6b6b","font-size":"40px","font-weight":"bold"}},"比赛结束",-1)])])):S("",!0)])]))}},ee=w(W,[["__scopeId","data-v-f45b5890"]]);export{ee as default};
