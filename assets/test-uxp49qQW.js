import{_ as $,r as o,h as C,i as F,j as I,c,o as m,b as s,k as B,t as u,F as T,f as k,l as N}from"./index-CnmFkFAA.js";import{F as D}from"./FlipDigit-DbOjMXLV.js";const U={class:"background"},J={class:"vice-panel"},O={class:"vice-teams"},M={class:"vice-team"},V={class:"vice-team-name team-a"},j={class:"flip-wrapper",style:{"margin-top":"14px"}},q={class:"vice-team"},z={class:"vice-team-name team-b"},E={class:"flip-wrapper",style:{"margin-top":"14px"}},L={class:"vice-timer-section"},R={class:"vice-period"},G={class:"vice-main-timer"},H={key:0,class:"vice-24s-section"},K={class:"vice-24s"},P={key:1,class:"vice-rest"},Q={class:"rest-text",style:{color:"#49ddfa"}},W={key:2,class:"vice-end"},X={__name:"test",setup(Y){const x=F(),t=o(null),n=o({name:"",score:0,players:[]}),i=o({name:"",score:0,players:[]}),p=o(1),d=o(12*60),y=o(22),f=o(0),r=o("playing");function S(l){const e=String(Math.floor(l/60)).padStart(2,"0"),a=String(l%60).padStart(2,"0");return`${e}:${a}`}let _=null,v=null;C(()=>{const l=x.query.data;if(l)try{t.value=JSON.parse(l),t.value.teamA&&(n.value.name=t.value.teamA.name||"",t.value.teamA.score!==void 0&&(n.value.score=t.value.teamA.score),t.value.teamA.players&&(n.value.players=t.value.teamA.players)),t.value.teamB&&(i.value.name=t.value.teamB.name||"",t.value.teamB.score!==void 0&&(i.value.score=t.value.teamB.score),t.value.teamB.players&&(i.value.players=t.value.teamB.players)),t.value.settings&&(d.value=t.value.settings.periodTime*60),t.value.matchName&&(document.title=t.value.matchName)}catch(e){console.error("解析数据失败:",e)}_=setInterval(()=>{w()},100);try{v=new BroadcastChannel("matchDataChannel"),v.onmessage=e=>{if(e.data.type==="dataUpdated"){const a=e.data.data;a.teamA&&(n.value.name=a.teamA.name||n.value.name,a.teamA.score!==void 0&&(n.value.score=a.teamA.score),a.teamA.players&&(n.value.players=a.teamA.players)),a.teamB&&(i.value.name=a.teamB.name||i.value.name,a.teamB.score!==void 0&&(i.value.score=a.teamB.score),a.teamB.players&&(i.value.players=a.teamB.players)),a.playNumber!==void 0&&(p.value=a.playNumber),a.mainTime!==void 0&&(d.value=a.mainTime),a.smallTime!==void 0&&(y.value=a.smallTime),a.restTime!==void 0&&(f.value=a.restTime),a.gameStatus!==void 0&&(r.value=a.gameStatus),t.value=a}}}catch{console.log("BroadcastChannel not supported")}});function w(){try{const l=localStorage.getItem("matchSyncData");if(l&&l!==JSON.stringify(t.value))try{const e=JSON.parse(l);e.teamA&&(n.value.name=e.teamA.name||n.value.name,e.teamA.score!==void 0&&(n.value.score=e.teamA.score),e.teamA.players&&(n.value.players=e.teamA.players)),e.teamB&&(i.value.name=e.teamB.name||i.value.name,e.teamB.score!==void 0&&(i.value.score=e.teamB.score),e.teamB.players&&(i.value.players=e.teamB.players)),e.playNumber!==void 0&&(p.value=e.playNumber),e.mainTime!==void 0&&(d.value=e.mainTime),e.smallTime!==void 0&&(y.value=e.smallTime),e.restTime!==void 0&&(f.value=e.restTime),e.gameStatus!==void 0&&(r.value=e.gameStatus),t.value=e}catch(e){console.error("更新数据失败:",e)}}catch(l){console.error("检查数据更新失败:",l)}}I(()=>{_&&clearInterval(_),v&&(v.close(),v=null)});function b(l){const e=String(l).padStart(3,"0");return console.log(`Formatted score: ${l} -> [${e[0]}, ${e[1]}, ${e[2]}]`),[e[0],e[1],e[2]]}return(l,e)=>{var a,A;return m(),c("div",U,[s("div",J,[e[3]||(e[3]=s("div",{class:"vice-title"},"队伍",-1)),s("div",O,[s("div",M,[s("div",V,u(n.value.name),1),s("div",j,[(m(!0),c(T,null,k(b(n.value.score),(g,h)=>(m(),N(D,{key:"a"+h,number:g.toString()},null,8,["number"]))),128))])]),e[0]||(e[0]=s("div",{style:{width:"38px"}},null,-1)),s("div",q,[s("div",z,u(i.value.name),1),s("div",E,[(m(!0),c(T,null,k(b(i.value.score),(g,h)=>(m(),N(D,{key:"b"+h,number:g.toString()},null,8,["number"]))),128))])])]),s("div",L,[s("span",R,"第"+u(p.value)+"节"+u(r.value==="resting"?"休息":r.value==="ended"?"比赛结束":"比赛"),1),s("span",G,u(S(r.value==="resting"?f.value:d.value)),1)]),r.value!=="resting"&&t.value&&((A=(a=t.value.value)==null?void 0:a.settings)!=null&&A.enable24Seconds)?(m(),c("div",H,[e[1]||(e[1]=s("span",{class:"vice-24s-label"},"24秒",-1)),s("span",K,u(y.value),1)])):B("",!0),r.value==="resting"?(m(),c("div",P,[s("span",Q,"节间休息："+u(S(f.value)),1)])):B("",!0),r.value==="ended"?(m(),c("div",W,[...e[2]||(e[2]=[s("span",{class:"end-text",style:{color:"#ff6b6b","font-size":"40px","font-weight":"bold"}},"比赛结束",-1)])])):B("",!0)])])}}},ae=$(X,[["__scopeId","data-v-3f14571b"]]);export{ae as default};
